"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["plugin-vat-validation"],{4613:(e,t,r)=>{const i={name:"Austria",codes:["AT","AUT","040"],calcFn:e=>{let t=0;for(let r=0;r<7;r++){const s=Number(e.charAt(r))*i.rules.multipliers.common[r];t+=s>9?Math.floor(s/10)+s%10:s}return t=10-(t+4)%10,10===t&&(t=0),t===Number(e.slice(7,8))},rules:{multipliers:{common:[1,2,1,2,1,2,1]},regex:[/^(AT)U(\d{8})$/]}},s=e=>e%11<2?0:11-e%11,n={name:"Brazil",codes:["BR","BRA","076"],calcFn:e=>{const t=e.split("").map(Number);if((r=t).every((e=>r[0]===e)))return!1;var r;const i=((e,t)=>t.reduce((([t,r],i,s)=>[0===s?0:t+e[s-1]*i,r+e[s]*i]),[0,0]))(t,[6,5,4,3,2,9,8,7,6,5,4,3,2]);return t[12]===s(i[0])&&t[13]===s(i[1])},rules:{multipliers:{},regex:[/^(BR)?(\d{14}|\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2})$/]}},l={name:"Bulgaria",codes:["BG","BGR","100"],calcFn:e=>{if(9===e.length)return function(e){let t,r=o(0,e,0,8,1);const i=Number(e.slice(8));if(t=r%11,10!==t)return t===i;r=o(0,e,0,8,3),t=r%11,10===t&&(t=0);return t===i}(e);const{multipliers:t}=l.rules;return function(e,t){if(/^\d\d[0-5]\d[0-3]\d\d{4}$/.test(e)){const r=Number(e.slice(2,4));if(r>0&&r<13||r>20&&r<33||r>40&&r<53){let r=a(0,e,0,9,t);if(r%=11,10===r&&(r=0),r===Number(e.substr(9,1)))return!0}}return!1}(e,t.physical)||function(e,t){const r=a(0,e,0,9,t.foreigner);return r%10===Number(e.substr(9,1))}(e,t)||function(e,t){let r=a(0,e,0,9,t.miscellaneous);if(r=11-r%11,10===r)return!1;11===r&&(r=0);const i=Number(e.substr(9,1));return r===i}(e,t)},rules:{multipliers:{physical:[2,4,8,5,10,9,7,3,6],foreigner:[21,19,17,13,11,9,7,3,1],miscellaneous:[4,3,2,7,6,5,4,3,2]},regex:[/^(BG)(\d{9,10})$/]}};function o(e,t,r,i,s){let n=e;for(let e=r;e<i;e++)n+=Number(t.charAt(e))*(e+s);return n}function a(e,t,r,i,s){let n=e;for(let e=r;e<i;e++)n+=Number(t.charAt(e))*s[e];return n}const u={name:"Czech Republic",codes:["CZ","CZE","203"],calcFn:e=>{const{rules:t}=u,{multipliers:r,additional:i,lookup:s}=t;return!!i&&(function(e,t,r){let i=0;if(r[0].test(e)){for(let r=0;r<7;r++)i+=Number(e.charAt(r))*t[r];i=11-i%11,10===i&&(i=0),11===i&&(i=1);return i===Number(e.slice(7,8))}return!1}(e,r.common,i)||function(e,t,r,i){let s=0;if(r[2].test(e)){for(let r=0;r<7;r++)s+=Number(e.charAt(r+1))*t[r];let r;r=s%11==0?s+11:11*Math.ceil(s/11);const n=r-s-1,l=Number(e.slice(8,9));return!!i&&i[n]===l}return!1}(e,r.common,i,s)||function(e,t){if(t[3].test(e)){const t=Number(e.slice(0,2))+Number(e.slice(2,4))+Number(e.slice(4,6))+Number(e.slice(6,8))+Number(e.slice(8)),r=Number(e)%11==0;return!(t%11!=0||!r)}return!1}(e,i)||function(e,t){if(t[1].test(e))return Number(e.slice(0,2))<=62;return!1}(e,i))},rules:{multipliers:{common:[8,7,6,5,4,3,2]},lookup:[8,7,6,5,4,3,2,1,0,9,8],regex:[/^(CZ)(\d{8,10})(\d{3})?$/],additional:[/^\d{8}$/,/^[0-5][0-9][0|1|5|6]\d[0-3]\d\d{3}$/,/^6\d{8}$/,/^\d{2}[0-3|5-8]\d[0-3]\d\d{4}$/]}};const c={name:"Denmark",codes:["DK","DNK","208"],calcFn:e=>{let t=0;for(let r=0;r<8;r++)t+=Number(e.charAt(r))*c.rules.multipliers.common[r];return t%11==0},rules:{multipliers:{common:[2,7,6,5,4,3,2,1]},regex:[/^(DK)(\d{8})$/]}},m={name:"Estonia",codes:["EE","EST","233"],calcFn:e=>{let t,r=0;for(let t=0;t<8;t++)r+=Number(e.charAt(t))*m.rules.multipliers.common[t];return r=10-r%10,10===r&&(r=0),t=Number(e.slice(8,9)),r===t},rules:{multipliers:{common:[3,7,1,3,7,1,3,7]},regex:[/^(EE)(10\d{7})$/]}},d={name:"Finland",codes:["FI","FIN","246"],calcFn:e=>{let t=0;for(let r=0;r<7;r++)t+=Number(e.charAt(r))*d.rules.multipliers.common[r];t=11-t%11,t>9&&(t=0);return t===Number(e.slice(7,8))},rules:{multipliers:{common:[7,9,10,5,8,4,2]},regex:[/^(FI)(\d{8})$/]}},h={name:"Germany",codes:["DE","DEU","276"],calcFn:e=>{let t,r=10,i=0,s=0;for(let t=0;t<8;t++)i=(Number(e.charAt(t))+r)%10,0===i&&(i=10),r=2*i%11;return s=11-r==10?0:11-r,t=Number(e.slice(8,9)),s===t},rules:{multipliers:{},regex:[/^(DE)([1-9]\d{8})$/]}},p={name:"Greece",codes:["GR","GRC","300"],calcFn:e=>{let t=0;const r=8===e.length?"0"+e:e;for(let e=0;e<8;e++)t+=Number(r.charAt(e))*p.rules.multipliers.common[e];t%=11,t=t>9?0:t;return t===Number(r.slice(8,9))},rules:{multipliers:{common:[256,128,64,32,16,8,4,2]},regex:[/^(EL)(\d{9})$/]}},f={name:"Hungary",codes:["HU","HUN","348"],calcFn:e=>{let t=0;for(let r=0;r<7;r++)t+=Number(e.charAt(r))*f.rules.multipliers.common[r];t=10-t%10,10===t&&(t=0);return t===Number(e.slice(7,8))},rules:{multipliers:{common:[9,7,3,1,9,7,3]},regex:[/^(HU)(\d{8})$/]}},b={name:"Ireland",codes:["IE","IRL","372"],calcFn:e=>{const{typeFormats:t,multipliers:r}=b.rules;if(!t||!t.first)return!1;let i=0,s=e;t.first.test(e)&&(s="0"+e.substring(2,7)+e.substring(0,1)+e.substring(7,8));for(let e=0;e<7;e++)i+=Number(s.charAt(e))*r.common[e];t.third.test(s)&&(i+="H"===s.charAt(8)?72:9),i%=23,i=0===i?"W":String.fromCharCode(i+64);return i===s.slice(7,8)},rules:{multipliers:{common:[8,7,6,5,4,3,2]},typeFormats:{first:/^\d[A-Z*+]/,third:/^\d{7}[A-Z][AH]$/},regex:[/^(IE)(\d{7}[A-W])$/,/^(IE)([7-9][A-Z*+)]\d{5}[A-W])$/,/^(IE)(\d{7}[A-W][AH])$/]}},g={name:"Italy",codes:["IT","ITA","380"],calcFn:e=>{let t,r=0;if(0===Number(e.slice(0,7)))return!1;if(t=Number(e.slice(7,10)),t<1||t>201&&999!==t&&888!==t)return!1;for(let i=0;i<10;i++)t=Number(e.charAt(i))*g.rules.multipliers.common[i],r+=t>9?Math.floor(t/10)+t%10:t;r=10-r%10,r>9&&(r=0);return r===Number(e.slice(10,11))},rules:{multipliers:{common:[1,2,1,2,1,2,1,2,1,2]},regex:[/^(IT)(\d{11})$/]}},v={name:"Latvia",codes:["LV","LVA","428"],calcFn:e=>{let t=0;if(/^[0-3]/.test(e))return Boolean(/^[0-3][0-9][0-1][0-9]/.test(e));for(let r=0;r<10;r++)t+=Number(e.charAt(r))*v.rules.multipliers.common[r];t%11==4&&9===Number(e[0])&&(t-=45),t%11==4?t=4-t%11:t%11>4?t=14-t%11:t%11<4&&(t=3-t%11);return t===Number(e.slice(10,11))},rules:{multipliers:{common:[9,1,4,8,3,10,2,5,7,6]},regex:[/^(LV)(\d{11})$/]}},A={name:"Lithuania",codes:["LT","LTU","440"],calcFn:e=>function(e,t){let r=0;if(9===e.length){if(!/^\d{7}1/.test(e))return!1;r=function(e,t){let r=t;for(let t=0;t<8;t++)r+=Number(e.charAt(t))*(t+1);return r}(e,r),r=function(e,t,r){let i=t;if(i%11==10){i=0;for(let t=0;t<8;t++)i+=N(e,r.multipliers.short,t)}return i}(e,r,t),r=y(r);return r===Number(e.slice(8,9))}return!1}(e,A.rules)||function(e,t){let r=0;if(12===e.length){if(!t.check)return!1;if(!t.check.test(e))return!1;r=function(e,t,r){let i=t;for(let t=0;t<11;t++)i+=N(e,r.multipliers.med,t);return i}(e,r,t),r=function(e,t,r){let i=t;if(t%11==10){i=0;for(let t=0;t<11;t++)i+=N(e,r.multipliers.alt,t)}return i}(e,r,t),r=y(r);return r===Number(e.slice(11,12))}return!1}(e,A.rules),rules:{multipliers:{short:[3,4,5,6,7,8,9,1],med:[1,2,3,4,5,6,7,8,9,1,2],alt:[3,4,5,6,7,8,9,1,2,3,4]},check:/^\d{10}1/,regex:[/^(LT)(\d{9}|\d{12})$/]}};function N(e,t,r){return Number(e.charAt(r))*t[r]}function y(e){let t=e%11;return 10===t&&(t=0),t}const $={name:"Malta",codes:["MT","MLT","470"],calcFn:e=>{let t=0;for(let r=0;r<6;r++)t+=Number(e.charAt(r))*$.rules.multipliers.common[r];t=37-t%37;return t===Number(e.slice(6,8))},rules:{multipliers:{common:[3,4,6,7,8,9]},regex:[/^(MT)([1-9]\d{7})$/]}},V={name:"Netherlands",codes:["NL","NLD","528"],calcFn:e=>{const t=e.replace(/[\ \-\_]/g,"").toUpperCase(),{additional:r,multipliers:i}=V.rules;if(!r)return!1;const s=t.match(r[0]);if(!s||!s[1])return!1;const n=s[1],l=`NL${t}`.split("").map(S);let o=0;for(let e=0;e<8;e++)o+=Number(n.charAt(e))*i.common[e];o%=11,o>9&&(o=0);return o===Number(n.slice(8,9))||1===function(e,t){let r=0;for(const i of e.split(""))r=(10*r+ +i)%t;return r}(l.join(""),97)},rules:{multipliers:{common:[9,8,7,6,5,4,3,2]},regex:[/^(NL)(\d{9}B\d{2})$/],additional:[/^(\d{9})B\d{2}$/]}};function S(e){if("+"===e)return 36;if("*"===e)return 37;const t=e.charCodeAt(0)-55;return t>9&&t<91?t:parseInt(e,10)}const _={name:"Norway",codes:["NO","NOR","578"],calcFn:e=>{let t=0;for(let r=0;r<8;r++)t+=Number(e.charAt(r))*_.rules.multipliers.common[r];if(t=11-t%11,11===t&&(t=0),t<10){return t===Number(e.slice(8,9))}return!1},rules:{multipliers:{common:[3,2,7,6,5,4,3,2]},regex:[/^(NO)(\d{9})(MVA)?$/]}},E={name:"Poland",codes:["PL","POL","616"],calcFn:e=>{let t=0;for(let r=0;r<9;r++)t+=Number(e.charAt(r))*E.rules.multipliers.common[r];t%=11,t>9&&(t=0);return t===Number(e.slice(9,10))},rules:{multipliers:{common:[6,5,7,2,3,4,5,6,7]},regex:[/^(PL)(\d{10})$/]}},F={name:"Portugal",codes:["PT","PRT","620"],calcFn:e=>{let t=0;for(let r=0;r<8;r++)t+=Number(e.charAt(r))*F.rules.multipliers.common[r];t=11-t%11,t>9&&(t=0);return t===Number(e.slice(8,9))},rules:{multipliers:{common:[9,8,7,6,5,4,3,2]},regex:[/^(PT)(\d{9})$/]}},C={name:"Romania",codes:["RO","ROU","642"],calcFn:e=>{let t=0;const r=e.length,i=C.rules.multipliers.common.slice(10-r);for(let r=0;r<e.length-1;r++)t+=Number(e.charAt(r))*i[r];t=10*t%11,10===t&&(t=0);return t===Number(e.slice(e.length-1,e.length))},rules:{multipliers:{common:[7,5,3,2,1,7,5,3,2]},regex:[/^(RO)([1-9]\d{1,9})$/]}},I={name:"Russian Federation",codes:["RU","RUS","643"],calcFn:e=>function(e,t){let r=0;if(10===e.length){for(let i=0;i<10;i++)r+=Number(e.charAt(i))*t.multipliers.m_1[i];r%=11,r>9&&(r%=10);return r===Number(e.slice(9,10))}return!1}(e,I.rules)||function(e,t){let r=0,i=0;if(12===e.length){for(let i=0;i<11;i++)r+=Number(e.charAt(i))*t.multipliers.m_2[i];r%=11,r>9&&(r%=10);for(let r=0;r<11;r++)i+=Number(e.charAt(r))*t.multipliers.m_3[r];i%=11,i>9&&(i%=10);const s=r===Number(e.slice(10,11)),n=i===Number(e.slice(11,12));return s&&n}return!1}(e,I.rules),rules:{multipliers:{m_1:[2,4,10,3,5,9,4,6,8,0],m_2:[7,2,4,10,3,5,9,4,6,8,0],m_3:[3,7,2,4,10,3,5,9,4,6,8,0]},regex:[/^(RU)(\d{10}|\d{12})$/]}};const Z={name:"Slovenia",codes:["SI","SVN","705"],calcFn:e=>{let t=0;for(let r=0;r<7;r++)t+=Number(e.charAt(r))*Z.rules.multipliers.common[r];t=11-t%11,10===t&&(t=0);const r=Number(e.slice(7,8));return!(11===t||t!==r)},rules:{multipliers:{common:[8,7,6,5,4,3,2]},regex:[/^(SI)([1-9]\d{7})$/]}},L={name:"Spain",codes:["ES","ESP","724"],calcFn:e=>{const{additional:t,multipliers:r}=L.rules;return!!t&&(t[0].test(e)?function(e,t){let r=x(e,t,0);r=10-r%10,10===r&&(r=0);const i=Number(e.slice(8,9));return r===i}(e,r.common):t[1].test(e)?function(e,t){let r=x(e,t,0);r=10-r%10;const i=String.fromCharCode(r+64),s=e.slice(8,9);return i===s}(e,r.common):t[2].test(e)?function(e){let t=e;"Y"===t.substring(0,1)&&(t=t.replace(/Y/,"1"));"Z"===t.substring(0,1)&&(t=t.replace(/Z/,"2"));const r="TRWAGMYFPDXBNJZSQVHLCKE".charAt(+t.substring(0,8)%23);return t.charAt(8)===r}(e):!!t[3].test(e)&&function(e){const t="TRWAGMYFPDXBNJZSQVHLCKE".charAt(Number(e.substring(1,8))%23);return e.charAt(8)===t}(e))},rules:{multipliers:{common:[2,1,2,1,2,1,2]},regex:[/^(ES)([A-Z]\d{8})$/,/^(ES)([A-HN-SW]\d{7}[A-J])$/,/^(ES)([0-9YZ]\d{7}[A-Z])$/,/^(ES)([KLMX]\d{7}[A-Z])$/],additional:[/^[A-H|J|U|V]\d{8}$/,/^[A-H|N-S|W]\d{7}[A-J]$/,/^[0-9|Y|Z]\d{7}[A-Z]$/,/^[K|L|M|X]\d{7}[A-Z]$/]}};function x(e,t,r){let i,s=r;for(let r=0;r<7;r++)i=Number(e.charAt(r+1))*t[r],s+=i>9?Math.floor(i/10)+i%10:i;return s}const T={name:"Sweden",codes:["SE","SWE","752"],calcFn:e=>{let t,r=0;for(let t=0;t<9;t+=2){const i=Number(e.charAt(t));r+=Math.floor(i/5)+2*i%10}let i=0;for(let t=1;t<9;t+=2)i+=Number(e.charAt(t));const s=(10-(r+i)%10)%10;return t=Number(e.slice(9,10)),s===t},rules:{multipliers:{},regex:[/^(SE)(\d{10}01)$/]}},R={name:"Switzerland",codes:["CH","CHE","756"],calcFn:e=>{let t=0;for(let r=0;r<8;r++)t+=Number(e.charAt(r))*R.rules.multipliers.common[r];if(t=11-t%11,10===t)return!1;11===t&&(t=0);return t===Number(e.substr(8,1))},rules:{multipliers:{common:[5,4,3,2,7,6,5,4]},regex:[/^(CHE)(\d{9})(MWST|TVA|IVA)?$/]}},q={name:"United Kingdom",codes:["GB","GBR","826"],calcFn:e=>"GD"===e.substr(0,2)?function(e){const t=500;return Number(e.substr(2,3))<t}(e):"HA"===e.substr(0,2)?function(e){const t=499;return Number(e.substr(2,3))>t}(e):function(e,t){let r=0;if(0===Number(e.slice(0)))return!1;const i=Number(e.slice(0,7));for(let i=0;i<7;i++)r+=Number(e.charAt(i))*t[i];let s=r;for(;s>0;)s-=97;if(s=Math.abs(s),s===Number(e.slice(7,9))&&i<9990001&&(i<1e5||i>999999)&&(i<9490001||i>97e5))return!0;s>=55?s-=55:s+=42;const n=Number(e.slice(7,9));return Boolean(s===n&&i>1e6)}(e,q.rules.multipliers.common),rules:{multipliers:{common:[8,7,6,5,4,3,2]},regex:[/^(GB)?(\d{9})$/,/^(GB)?(\d{12})$/,/^(GB)?(GD\d{3})$/,/^(GB)?(HA\d{3})$/]}};function w(e,t,r){return{value:e||void 0,isValid:Boolean(t),isValidFormat:!!r&&B(e,r.rules.regex).isValid,isSupportedCountry:Boolean(r),country:r?{name:r.name,isoCode:{short:r.codes[0],long:r.codes[1],numeric:r.codes[2]}}:void 0}}const P=[n.name];function D(e){return!!e.match(/^\d{2}/)}function M(e,t){const r=function(e){return[...e.codes,"Greece"===e.name?"EL":void 0].filter(Boolean)}(t);return r.filter((t=>e.startsWith(t))).length>0}function B(e,t){for(const r of t){if(r.test(e))return{isValid:!0,regex:r}}return{isValid:!1,regex:void 0}}function k(e,t=[]){if(!e)return w(e,!1);const r=function(e=""){return e.toString().toUpperCase().replace(/(\s|-|\.|\/)+/g,"")}(e),i=function(e,t){for(const i of t)if(M(e,i)||(r=i.name,P.includes(r)&&D(e)))return{...i};var r}(r,t),s=!!i&&function(e,t){const r=B(e,t.rules.regex);if(!r.isValid||!r.regex)return!1;const i=r.regex.exec(e);return!!i&&t.calcFn(i[2])}(r,i);return w(r,s,i)}const H=[{name:"Andorra",codes:["AD","AND","020"],calcFn:e=>8===e.length,rules:{multipliers:{},regex:[/^(AD)([fealecdgopuFEALECDGOPU]{1}\d{6}[fealecdgopuFEALECDGOPU]{1})$/]}},i,{name:"Belgium",codes:["BE","BEL","056"],calcFn:e=>{const t=9===e.length?"0"+e:e;if(0===Number(t.slice(1,2)))return!1;return 97-Number(t.slice(0,8))%97===Number(t.slice(8,10))},rules:{multipliers:{},regex:[/^(BE)(0?\d{9})$/]}},n,l,{name:"Croatia",codes:["HR","HRV","191"],calcFn:e=>{let t=10,r=0;for(let i=0;i<10;i++)r=(Number(e.charAt(i))+t)%10,0===r&&(r=10),t=2*r%11;return(t+Number(e.slice(10,11)))%10==1},rules:{multipliers:{},regex:[/^(HR)(\d{11})$/]}},{name:"Cyprus",codes:["CY","CYP","196"],calcFn:e=>{if(12===Number(e.slice(0,2)))return!1;let t=function(e,t){let r=t;for(let t=0;t<8;t++){let i=Number(e.charAt(t));if(t%2==0)switch(i){case 0:i=1;break;case 1:i=0;break;case 2:i=5;break;case 3:i=7;break;case 4:i=9;break;default:i=2*i+3}r+=i}return r}(e,0);t%=26,t=String.fromCharCode(t+65);return t===e.substr(8,1)},rules:{multipliers:{},regex:[/^(CY)([0-59]\d{7}[A-Z])$/]}},u,c,m,{name:"Europe",codes:["EU","EUR","000"],calcFn:()=>!0,rules:{multipliers:{},regex:[/^(EU)(\d{9})$/]}},d,{name:"France",codes:["FR","FRA","250"],calcFn:e=>{let t;if(!/^\d{11}$/.test(e))return!0;t=Number(e.substring(2)),t=(100*t+12)%97;return t===Number(e.slice(0,2))},rules:{multipliers:{},regex:[/^(FR)(\d{11})$/,/^(FR)([A-HJ-NP-Z]\d{10})$/,/^(FR)(\d[A-HJ-NP-Z]\d{9})$/,/^(FR)([A-HJ-NP-Z]{2}\d{9})$/]}},h,p,f,b,g,v,A,{name:"Luxembourg",codes:["LU","LUX","442"],calcFn:e=>{const t=Number(e.slice(6,8));return Number(e.slice(0,6))%89===t},rules:{multipliers:{},regex:[/^(LU)(\d{8})$/]}},$,V,_,E,F,C,I,{name:"Serbia",codes:["RS","SRB","688"],calcFn:e=>{let t=10,r=0;for(let i=0;i<8;i++)r=(Number(e.charAt(i))+t)%10,0===r&&(r=10),t=2*r%11;return 1===(t+Number(e.slice(8,9)))%10},rules:{multipliers:{},regex:[/^(RS)(\d{9})$/]}},{name:"Slovakia Republic",codes:["SK","SVK","703"],calcFn:e=>0===Number(e)%11,rules:{multipliers:{},regex:[/^(SK)([1-9]\d[2346-9]\d{7})$/]}},Z,L,T,R,q];var U=r(6285),O=r(8254),j=r(4690);function G(e){return e.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})).join(" ")}var K,W,J,Y=r(3206),X=r(1966);class z extends U.Z{init(){this._client=new O.Z,this.$companyVatId=Y.Z.querySelector(this.el,this.options.companyVatIdSelector),this.$companyName=Y.Z.querySelector(this.el,this.options.companyNameSelector),this.$companyAddress=Y.Z.querySelector(this.el,this.options.companyAddressSelector),this.$companyZipcode=Y.Z.querySelector(this.el,this.options.companyZipcodeSelector),this.$companyCity=Y.Z.querySelector(this.el,this.options.companyCitySelector),this.$companyCountry=Y.Z.querySelector(this.el,this.options.companyCountrySelector),this._registerEvents()}_registerEvents(){this.$companyVatId.addEventListener("change",this._onChange.bind(this))}_onChange(e){const t=e.target.value.trim(),{isValid:r,country:i}=k(t,H);r&&(this._resetAllCompanyRegistrationValues(),this._fetchData(t,i))}_fetchData(e,{name:t}){return j.Z.create(this.$companyVatId.parentNode),new Promise(((r,i)=>{this._client.get(`store-api/company/${e}`,((e,s)=>{j.Z.remove(this.$companyVatId.parentNode),s.status>=400&&i("Failed to parse vat validation info from VIES response"),this._parseData(e),this._setSelectOption(this.$companyCountry,t),r()}))}))}_parseData(e){const{traderName:t,traderAddress:r}=JSON.parse(e),i=r.trim("\n").replace("\n",", "),[,s,n,l]=i.match(/^([^,]+), (\S+) ([^,]+)$/);this._setInputValue(this.$companyName,t),this._setInputValue(this.$companyAddress,s,!0),this._setInputValue(this.$companyZipcode,n),this._setInputValue(this.$companyCity,l,!0)}_resetAllCompanyRegistrationValues(){const e=[this.$companyName,this.$companyAddress,this.$companyZipcode,this.$companyCity,this.$companyCountry];X.Z.iterate(e,(e=>{switch(e.tagName){case"INPUT":this._resetInputValue(e);break;case"SELECT":this._resetSelectOption(e);break;default:throw new Error("This element cannot be handled.")}}))}_setSelectOption(e,t){X.Z.iterate(e.options,((r,i)=>{e.options[i].text===t&&(e.options[i].selected=!0)}))}_setInputValue(e,t,r=!1){e.value=r?G(t):t}_resetSelectOption(e){e.options[0].selected=!0}_resetInputValue(e){e.value=""}}K=z,J={companyVatIdSelector:"#vatIds",companyNameSelector:"#billingAddresscompany",companyAddressSelector:"#billingAddressAddressStreet",companyZipcodeSelector:"#billingAddressAddressZipcode",companyCitySelector:"#billingAddressAddressCity",companyCountrySelector:"#billingAddressAddressCountry"},(W=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(W="options"))in K?Object.defineProperty(K,W,{value:J,enumerable:!0,configurable:!0,writable:!0}):K[W]=J;class Q extends U.Z{init(){this._client=new O.Z,this.$companyVatId=Y.Z.querySelector(this.el,this.options.companyVatIdSelector),this.$companyName=Y.Z.querySelector(this.el,this.options.companyNameSelector),this._registerEvents()}_registerEvents(){this.$companyVatId.addEventListener("change",this._onChange.bind(this))}_onChange(e){const t=e.target.value.trim(),{isValid:r}=k(t,H);r&&(this._resetAllCompanyRegistrationValues(),this._fetchData(t))}_fetchData(e){return j.Z.create(this.$companyVatId.parentNode),new Promise(((t,r)=>{this._client.get(`store-api/company/${e}`,((i,s)=>{if(j.Z.remove(this.$companyVatId.parentNode),s.status>=400)return r("Failed to parse vat validation info from VIES response"),void this._showInvalidVatMessage(e);this._parseData(i),t()}))}))}_showInvalidVatMessage(e){const t=this.$companyVatId.parentElement,r=Y.Z.getDataAttribute(this.$companyVatId,this.options.viesCheckFailedMessage,!1);t&&t.classList.add(this.options.styleCls),this.$companyVatId.insertAdjacentHTML("afterEnd",`<div class="invalid-feedback js-validation-message" data-type="${this.options.vatAttr}">${r}</div>`),this.$companyVatId.setCustomValidity(r),this.$companyVatId.setAttribute("invalid",!0)}_parseData(e){const{traderName:t}=JSON.parse(e);this._setInputValue(this.$companyName,t)}_resetAllCompanyRegistrationValues(){this._resetInputValue(this.$companyName)}_setInputValue(e,t,r=!1){e.value=r?G(t):t}_resetInputValue(e){e.value=""}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Q,"options",{companyVatIdSelector:"#vatIds",companyNameSelector:"#company",vatAttr:"data-form-validation-vat-valid",viesCheckFailedMessage:"data-form-validation-vies-check-failed-message",styleCls:"was-validated"});var ee=r(1186);class te extends ee.Z{_registerEvents(){super._registerEvents(),this._registerValidationListener(this.options.vatAttr,this._onValidateVat.bind(this),["change"])}_onValidateVat(e){const t=e.target,r=t.value.trim(),{isValid:i}=k(r,H);r&&!i?this._setFieldToInvalid(t,this.options.vatAttr):this._setFieldToValid(t,this.options.vatAttr),this.$emitter.publish("onValidateVat")}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(te,"options",{...ee.Z.options,vatAttr:"data-form-validation-vat-valid"});const re=window.PluginManager;re.register("VatValidationLoaderDataPlugin",z,".register-form"),re.override("FormValidation",te,"[data-form-validation]"),re.register("AccountProfileVatValidationLoaderDataPlugin",Q,"#profilePersonalForm")},1186:(e,t,r)=>{r.d(t,{Z:()=>c});var i,s,n,l=r(6285),o=r(3206),a=r(46),u=r(1966);class c extends l.Z{init(){if(!1===this._isFormElement())throw Error("Element is not of type <form>");this.options.stylingEnabled&&this._setNoValidate(),this._registerEvents()}_isFormElement(){return"form"===this.el.tagName.toLowerCase()}_setNoValidate(){this.el.setAttribute("novalidate","")}_registerEvents(){this.options.stylingEnabled&&this.el.addEventListener("submit",this._onFormSubmit.bind(this)),this._registerValidationListener(this.options.equalAttr,this._onValidateEqualTrigger.bind(this),["change"]),this._registerValidationListener(this.options.equalAttr,a.Z.debounce(this._onValidateEqual.bind(this),this.options.debounceTime),[this.options.eventName]),this._registerValidationListener(this.options.lengthAttr,this._onValidateLength.bind(this),["change"]),this._registerValidationListener(this.options.requiredAttr,this._onValidateRequired.bind(this),["change"])}_registerValidationListener(e,t,r){const i=o.Z.querySelectorAll(this.el,`[${e}]`,!1);i&&u.Z.iterate(i,(e=>{u.Z.iterate(r,(r=>{e.removeEventListener(r,t),e.addEventListener(r,t)}))}))}_onFormSubmit(e){const t=this.el.checkValidity();!1===t&&(e.preventDefault(),e.stopPropagation()),this.el.classList.add(this.options.styleCls),this.$emitter.publish("beforeSubmit",{validity:t})}_onValidateEqualTrigger(e){const t=o.Z.getDataAttribute(e.target,this.options.equalAttr),r=o.Z.querySelectorAll(this.el,`[${this.options.equalAttr}='${t}']`);r[1].value.trim().length>0&&u.Z.iterate(r,(t=>{t.dispatchEvent(new CustomEvent(this.options.eventName,{target:e.target}))})),this.$emitter.publish("onValidateEqualTrigger")}_onValidateEqual(e){const t=o.Z.getDataAttribute(e.target,this.options.equalAttr),r=o.Z.querySelectorAll(this.el,`[${this.options.equalAttr}='${t}']`);let i=!0;[...r].reduce(((e,t)=>{e.value.trim()!==t.value.trim()&&(i=!1)})),u.Z.iterate(r,(e=>{i?this._setFieldToValid(e,this.options.equalAttr):this._setFieldToInvalid(e,this.options.equalAttr)})),this.$emitter.publish("onValidateEqual")}_onValidateLength(e){const t=e.target,r=t.value.trim(),i=o.Z.getDataAttribute(e.target,this.options.lengthAttr),s=t.nextElementSibling;r.length<i?(this._setFieldToInvalid(t,this.options.lengthAttr),s&&s.hasAttribute(this.options.lengthTextAttr)&&s.classList.add(this.options.hintCls)):(this._setFieldToValid(t,this.options.lengthAttr),s&&s.hasAttribute(this.options.lengthTextAttr)&&s.classList.remove(this.options.hintCls)),this.$emitter.publish("onValidateLength")}_onValidateRequired(e){const t=e.target;""===t.value.trim()?this._setFieldToInvalid(t,this.options.requiredAttr):this._setFieldToValid(t,this.options.requiredAttr),this.$emitter.publish("onValidateRequired")}_setFieldToInvalid(e,t){this._showInvalidMessage(e,t),e.setAttribute("invalid",!0),this.$emitter.publish("setFieldToInvalid")}_showInvalidMessage(e,t){const r=e.parentElement;r&&this.options.stylingEnabled&&r.classList.add(this.options.styleCls);const i=o.Z.getDataAttribute(e,`${t}-message`,!1);i&&(r.querySelector(".js-validation-message")||e.insertAdjacentHTML("afterEnd",`<div class="invalid-feedback js-validation-message" data-type="${t}">${i}</div>`),e.setCustomValidity(i)),this.$emitter.publish("showInvalidMessage")}_setFieldToValid(e,t){this._hideInvalidMessage(e,t),e.removeAttribute("invalid"),e.setCustomValidity(""),this.$emitter.publish("setFieldToValid")}_hideInvalidMessage(e,t){const r=e.parentElement;if(r&&this.options.stylingEnabled&&r.classList.remove(this.options.styleCls),r){const e=o.Z.querySelector(r,`.js-validation-message[data-type=${t}]`,!1);e&&e.remove()}this.$emitter.publish("hideInvalidMessage")}}i=c,n={stylingEnabled:!0,styleCls:"was-validated",hintCls:"invalid-feedback",debounceTime:"150",eventName:"ValidateEqual",equalAttr:"data-form-validation-equal",lengthAttr:"data-form-validation-length",lengthTextAttr:"data-form-validation-length-text",requiredAttr:"data-form-validation-required"},(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s="options"))in i?Object.defineProperty(i,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[s]=n}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=4613,e(e.s=t);var t}));e.O()}]);